<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>new</title>
    <script src="echarts.js"></script>
    <script src="world.js"></script>
    <script src="d3.js"></script>
</head>
<style>
    div{float:left}
</style>
<body bgcolor="#3b5769"></body>
<body>

<div id="main" style="width:60%;height: 900px;"></div>
<script>
    var chart = echarts.init(document.getElementById('main'));
    var superdata=[];
    //
    var paralllelName = [
        "Country Name",
        "GDP",
        "GDP增长率",
        "互联网用户",
        "农村人口",
        "女性人口",
        "总人口",
        "人口增长率",
        "人均GDP增长率",
        "人均GDP",
        "劳动力人数",
        "女性劳动力",
        "武装部队人员",
        "国土面积",
        "人口密度",
        "耕地面积",
        "失业率",
        "女性失业率",
    ]
    var years=[1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014]
    var coordsMap={
        "Afghanistan":[67.71,33.94],
        "Albania":[20.17,41.15],
        "Algeria":[1.66,28.03],
        "American Samoa":[-170.80,-14.30],
        "Andorra":[1.52,42.51],
        "Angola":[17.87,-11.20],
        "Antigua and Barbuda":[-63.07,18.22],
        "Argentina":[-63.62,-38.42],
        "Armenia":[45.04,40.07],
        "Aruba":[],
        "Australia":[133.78,-25.27],
        "Austria":[14.55,47.52],
        "Azerbaijan":[47.58,40.14],
        "Bahamas":[-77.40,25.03],
        "Bahrain":[50.56,26.07],
        "Bangladesh":[90.36,23.68],
        "Barbados":[-59.54,13.19],
        "Belarus":[27.95,53.71],
        "Belgium":[4.47,50.50],
        "Belize":[-88.50,17.19],
        "Benin":[2.32,9.31],
        "Bermuda":[-64.75,32.31],
        "Bhutan":[90.36,27.56],
        "Bolivia":[-63.59,-16.29],
        "Bosnia and Herz.":[17.87,44.21],
        "Botswana":[24.68,-22.33],
        "Brazil":[-51.93,-14.24],
        "Brunei Darussalam":[114.73,4.54],
        "Bulgaria":[25.49,42.73],
        "Burkina Faso":[-1.56,12.24],
        "Burundi":[29.92,-3.37],
        "Cabo Verde":[-22.75,16.26],
        "Cambodia":[105.00, 12.56],
        "Cameroon":[12.35,7.37],
        "Canada":[-106.35,56.13],
        "Cayman Islands":[-80.78,19.22],
        "Central African Rep.":[20.94,6.61],
        "Chad":[18.73,15.45],
        "Channel Islands":[],
        "Chile":[-71.54,-35.68],
        "China":[104.20,35.86],
        "Colombia":[-74.30,4.57],
        "Comoros":[],
        "Dem. Rep. Congo":[22.83,-2.00],
        "Congo":[15.83,-0.23],
        "Costa Rica":[-83.75,9.75],
        "Cote d'Ivoire":[-5.43,7.43],
        "Croatia":[15.2,45.1],
        "Cuba":[-77.78,21.52],
        "Curacao":[],
        "Cyprus":[33.43,35.13],
        "Czech Rep.":[15.47,49.82],
        "Denmark":[9.50,56.26],
        "Djibouti":[42.59,11.83],
        "Dominica":[-0.19,51.52],
        "Dominican Rep.":[-70.29,18.97],
        "Ecuador":[-78.18,-1.83],
        "Egypt":[30.80,26.82],
        "El Salvador":[-88.90,13.79],
        "Eq. Guinea":[10.21,1.80],
        "Eritrea":[],
        "Estonia":[25.01,58.60],
        "Ethiopia":[40.49,9.15],
        "Faeroe Islands":[],
        "Fiji":[178.07,-17.71],
        "Finland":[25.75,61.92],
        "France":[2.21,46.23],
        "French Polynesia":[-53.13,3.93],
        "Gabon":[11.61,-0.80],
        "Gambia, The":[-15.31,13.44],
        "Georgia":[42.50,42.17],
        "Germany":[10.45,51.17],
        "Ghana":[-1.02,7.95],
        "Greece":[21.82,39.07],
        "Greenland":[-40.02,70.96],
        "Grenada":[-61.68,12.12],
        "Guam":[144.79,13.44],
        "Guatemala":[-90.23,15.78],
        "Guinea":[-9.70,9.95],
        "Guinea-Bissau":[],
        "Guyana":[-58.93,4.86],
        "Haiti":[-72.29,18.97],
        "Honduras":[-86.24,15.20],
        "Hong Kong SAR, China":[114.11,22.40],
        "Hungary":[19.50,47.16],
        "Iceland":[-19.02,64.96],
        "India":[78.96,20.59],
        "Indonesia":[113.92,-0.79],
        "Iran":[53.69,32.43],
        "Iraq":[43.68,33.22],
        "Ireland":[-8.24,53.41],
        "Isle of Man":[],
        "Israel":[34.85,31.05],
        "Italy":[12.57,41.87],
        "Jamaica":[-77.30,18.11],
        "Japan":[138.25,36.20],
        "Jordan":[36.24,30.59],
        "Kazakhstan":[66.92,48.02],
        "Kenya":[37.91,-0.02],
        "Kiribati":[-158.15,2.80],
        "Dem. Rep. Korea":[127.51,40.34],
        "Korea":[127.98,37.66],
        "Kosovo":[],
        "Kuwait":[47.48,29.31],
        "Kyrgyzstan":[74.77,41.20],
        "Lao PDR":[102.50,19.86],
        "Latvia":[24.60,56.88],
        "Lebanon":[35.86,33.85],
        "Lesotho":[28.23,-29.61],
        "Liberia":[-9.43,6.43],
        "Libya":[17.23,26.34],
        "Liechtenstein":[9.56,47.17],
        "Lithuania":[23.88,55.17],
        "Luxembourg":[6.13,49.82],
        "Macao SAR, China":[113.54,22.20],
        "Macedonia":[22.17,41.85],
        "Madagascar":[46.87,-18.77],
        "Malawi":[34.30,-13.25],
        "Malaysia":[101.98,4.21],
        "Maldives":[73.54,1.98],
        "Mali":[-4.00,17.57],
        "Malta":[14.38,35.94],
        "Marshall Islands":[172.07,3.71],
        "Mauritania":[-10.00,19.57],
        "Mauritius":[57.55,-20.35],
        "Mexico":[-102.55,23.63],
        "Micronesia, Fed. Sts.":[158.45,6.80],
        "Moldova":[28.57,46.88],
        "Monaco":[7.42,43.74],
        "Mongolia":[103.85,46.86],
        "Montenegro":[-62.19,16.74],
        "Morocco":[-7.09,31.79],
        "Mozambique":[35.53,-18.67],
        "Myanmar":[96.99, 20.87],
        "Namibia":[18.49,-22.96],
        "Nepal":[84.12,28.39],
        "Netherlands":[5.29,52.13],
        "New Caledonia":[],
        "New Zealand":[174.89,-40.90],
        "Nicaragua":[-85.21,12.87],
        "Niger":[8.08,17.61],
        "Nigeria":[8.68,9.08],
        "Northern Mariana Islands":[],
        "Norway":[8.47,60.47],
        "Oman":[55.98,21.47],
        "Pakistan":[69.35,30.38],
        "Palau":[],
        "Panama":[-80.78,8.54],
        "Papua New Guinea":[143.96,-6.31],
        "Paraguay":[-58.44,-23.44],
        "Peru":[-75.02,-9.19],
        "Philippines":[121.77,12.88],
        "Poland":[19.15,51.92],
        "Portugal":[-8.22,39.40],
        "Puerto Rico":[-66.59,18.22],
        "Qatar":[51.18,25.35],
        "Romania":[24.97,45.94],
        "Russia":[105.32,61.52],
        "Rwanda":[29.92,-1.87],
        "Samoa":[-172.15,-13.80],
        "San Marino":[12.46,43.94],
        "Sao Tome and Principe":[6.61,0.19],
        "Saudi Arabia":[45.08,23.89],
        "Senegal":[-14.45,14.50],
        "Serbia":[20.87,44.21],
        "Seychelles":[55.49,-4.68],
        "Sierra Leone":[-11.78,8.46],
        "Singapore":[103.82,1.35],
        "Sint Maarten (Dutch part)":[],
        "Slovakia":[19.70,48.67],
        "Slovenia":[15.00,46.15],
        "Solomon Islands":[160.96,-9.31],
        "Somalia":[46.20,5.15],
        "South Africa":[22.94,-30.56],
        "S. Sudan":[30.22,7.86],
        "Spain":[-3.75,40.46],
        "Sri Lanka":[80.77,7.87],
        "St. Kitts and Nevis":[],
        "St. Lucia":[-60.98,13.91],
        "St. Martin (French part)":[],
        "St. Vincent and the Grenadines":[-61.18,13.21],
        "Sudan":[30.22,12.86],
        "Suriname":[-56.03,3.92],
        "Swaziland":[31.47,-26.52],
        "Sweden":[18.64,60.13],
        "Switzerland":[8.23,46.82],
        "Syria":[39.00,34.80],
        "Tajikistan":[71.28,38.86],
        "Tanzania": [34.89, -6.37],
        "Thailand": [100.99, 15.87],
        "Timor-Leste":[],
        "Togo": [0.82, 8.62],
        "Tonga": [-175.20, -21.18],
        "Trinidad and Tobago": [-61.22, 10.69],
        "Tunisia": [9.54, 33.89],
        "Turkey": [35.24, 38.96],
        "Turkmenistan": [59.56, 38.97],
        "Turks and Caicos Islands":[],
        "Tuvalu":[],
        "Uganda": [32.29, 1.37],
        "Ukraine": [31.17, 48.38],
        "United Arab Emirates": [53.85, 23.42],
        "United Kingdom": [-3.44, 55.38],
        "United States": [-95.71, 37.09],
        "Uruguay": [-55.77, -32.52],
        "Uzbekistan": [64.59, 41.38],
        "Vanuatu":[166.96,-15.31],
        "Venezuela": [-66.59, 6.42],
        "Vietnam": [108.28, 14.06],
        "Virgin Islands (U.S.)":[-64.75,17.75],
        "Palestine":[35.30,32.05],
        "Yemen": [48.52, 15.55],
        "Zambia": [27.85, -13.13],
        "Zimbabwe": [29.15, -19.02],
    }

    d3.csv("countries_1990_2015.csv",function(data) {

        option= {

            baseOption:{
                timeline: {
                    axisType: 'category',
                    orient: 'vertical',
                    autoPlay: false,
                    inverse: true,
                    playInterval: 2000,
                    left: 0,
                    right: 10,
                    top: 20,
                    bottom: 20,
                    width: 50,
                    height: 650,
                    label: {
                        normal: {
                            textStyle: {
                                color: '#ddd'
                            }
                        },
                    },
                    lineStyle: {
                        color: '#fff'
                    },
                    checkpointStyle: {
                        color: '#bbb',
                        borderColor: '#777',
                        borderWidth: 2
                    },
                    controlStyle: {
                        showNextBtn: true,
                        showPrevBtn: true,
                        normal: {
                            color: '#666',
                            borderColor: '#666'
                        },
                        emphasis: {
                            color: '#aaa',
                            borderColor: '#fff'
                        }
                    },
                    data: years
                },
                //上面是年份的option

                backgroundColor: new echarts.graphic.RadialGradient(0.2, 0.5, 0.5, [{
                    offset: 0,
                    color: '#404a59'
                }, {
                    offset: 1,
                    color: '#3b576B'
                }]),
                title: {
                    text: 'TEST',
                    left: "87%",
                    top: 5,
                    itemGap: 0,
                    textStyle: {
                        color: '#eee',
                        fontSize:30,
                    },
                },
                //
                
                //最下面那些曲线的显示
                parallelAxis: makeParallelAxis(paralllelName),
                parallel: {
                    top: '60%',
                    left: 80,
                    right: 20,
                    bottom: 50,
                    axisExpandable: false,
                    axisExpandCenter: 8,
                    axisExpandCount: 15,
                    axisExpandWidth: 60,
                    axisExpandTriggerOn: 'mousemove',
                    inactiveOpacity:0.3,
                    activeOpacity:0.95,
                    parallelAxisDefault: {
                        type: 'value',
                        nameLocation: 'start',
                        nameRotate: 25,
                        nameTextStyle: {
                            show: false,
                            fontSize: 12
                        },
                        nameGap: 20,
                        tooltip: {
                            show: true
                        },
                        axisLine: {
                            lineStyle: {
                                width: 1,
                                color: 'rgba(255,255,255,0.3)'
                            }
                        },
                        axisTick: {
                            show: false
                        },
                        splitLine: {
                            show: false
                        },
                        axisLabel: {
                            fontSize: 7,
                            show: false
                        },
                    },
                },
                visualMap: {
                    type: 'continuous',
                    min: 0,
                    max: 2000000000000,
                    text:['High','Low'],
                    realtime: false,
                    calculable : true,
                    color: ['orangered','yellow','#577ceb']
                },
                geo:{
                    type: 'map',
                    map: 'world',
                    roam: true,
                    top: 20,
                    left: "10%",
                    bottom: '40%',
                    silent:true,
                    itemStyle: {
                        normal: {
                            areaColor: '#eeeeef',
                            borderColor: '#000'
                        },
                        emphasis: {
                            areaColor: '#ffd000'
                        }
                    },
                    label: {
                        emphasis: {
                            color: '#e20000',
                            show: false,
                        }
                    },
                    selectedMode:'multiple',
                },
                toolbox: {
                    show: true,
                    left: 'left',
                    iconStyle: {
                        normal: {
                            borderColor: '#ddd'
                        }
                    },
                    feature: {
                    },
                    z: 202
                },
                brush: {
                    geoIndex: 0,
                    brushLink: 'all',
                    inBrush: {
                        width: 0.9,
                        opacity: 0.9,
                        symbolSize: 4,
                    },
                    outOfBrush: {
                        color: '#fff',
                        opacity: 0.01
                    },
                },

                tooltip: {
                    trigger: 'item',
                    formatter: function (params) {
                        var money=params.data.value[2]/1000000000.0;
                        money=money.toFixed(3);
                        var year=selectYear+1990;
                        var output1="GDP增长率" + '&nbsp:&nbsp' + params.data.value[3].toFixed(3)+"%"+" &nbsp&nbsp&nbsp排名 "+" : "+getSortedNum(sortedAllYear(selectValue("NY.GDP.MKTP.KD.ZG"))[selectYear],params.name);
                        var output2="GDP"+" : "+money+"&nbspB$"+"&nbsp&nbsp&nbsp&nbsp"+"排名"+" : "+getSortedNum(sortedAllYear(selectValue("NY.GDP.MKTP.CD"))[selectYear],params.name);
                        var output3="人均GDP"+" : "+ params.data.value[10].toFixed(3)+"&nbsp$"+"&nbsp&nbsp&nbsp&nbsp"+"排名"+" : "+getSortedNum(sortedAllYear(selectValue("NY.GDP.PCAP.CD"))[selectYear],params.name);
                        var output4="人均GDP增长率"+" : "+ params.data.value[9].toFixed(3)+"%"+"&nbsp&nbsp&nbsp&nbsp"+"排名"+" : "+getSortedNum(sortedAllYear(selectValue("NY.GDP.PCAP.KD.ZG"))[selectYear],params.name);
                        return params.name +"----"+year+"年"+'<br/>'+output2+ '<br/>' + output1+'<br/>'+output3+'<br/>'+output4;
                    }
                },
            },
            options:[]
        };



        //鼠标触发
        chart.on('timeLineChanged', function (params) {
            selectYear = params.currentIndex;
        });

        var selectYear=0;

        function makeParallelAxis(paralllelName) {
            var parallelAxis = [];
            for (var i = 1; i < paralllelName.length; i++) {
                parallelAxis.push({
                    dim: i,
                    name: paralllelName[i],
                });
            }
            return parallelAxis;
        }

        var selectValue=function(value){                                        //按条件筛选     1
            selectData=[];
            for(var i=0;i<data.length;i++){
                for(var key in data[i]){
                    if(data[i][key]==value){
                        selectData.push(data[i]);
                    }
                }
            }
            return selectData;
        }
        // test=selectValue("NY.GDP.MKTP.CD");
        // console.log("selectValue");
        //  console.log(test);


        function getOneYear(test,year){                      //2.选出某个属性下某一年的数据
            var dataTemp={};
            year = year - 1986;
            for(var i=0;i<test.length;i++){
                var name = test[i].CountryName;
                var j = 0;
                for( var key in test[i]) {
                    if (j == year) {
                        strValue = parseFloat(test[i][key]);
                        if(strValue){
                            dataTemp[name] = strValue;
                        }
                        else {
                            dataTemp[name] = -100;
                        }
                    }
                    j += 1;
                }
            }
            return dataTemp;
        }
        // console.log("getOneYear");
        // console.log(getOneYear(selectValue("NY.GDP.MKTP.CD"),1990));


        function countrySort(dic){
            var dataSorted=[];                                   //3.筛选出某年的数据对国家排名，
            var res = Object.keys(dic).sort(function(a,b){
                return dic[b]-dic[a];
            });
            for(var i=0;i<res.length;i++)
                dataSorted[res[i]]=dic[res[i]];
            return dataSorted;
        }
        //  console.log("countrySort");
        // console.log(countrySort(getOneYear(selectValue("NY.GDP.MKTP.CD"),2010)));



        function sortedAllYear(test) {                              //所有排序过的信息
            dataSort = [];
            for(var i=1990;i<2016;i++){
                var temp = countrySort(getOneYear(test, i))
                dataSort.push(temp)
            }
            return dataSort
        }
        //  console.log("sortedAllYear")
        //  console.log(sortedAllYear(test))


        function getSortedNum(sortedData,countryName){                //得到排序的序列号
            var i=0;
            for(var key in sortedData){
                i+=1;
                if(key==countryName){
                    break;
                }
            }
            return i;
        }
        //  test2= countrySort(getOneYear(selectValue("AG.SRF.TOTL.K2"),2010));
        //  console.log(getSortedNum(test2,"China"));

        function dictToArray(dict) {
            var data = []
            for(var key in dict) {
                var arr = [];
                arr.push(key)
                arr = arr.concat(dict[key])
                data.push(arr)
            }
            return data
        }

        function makeMapData(rawData) {
            var mapData = [];
            for (var i = 0; i < rawData.length; i++) {
                var coords = coordsMap[rawData[i][0]]
                if (coords) {
                    mapData.push({
                        name: rawData[i][0],
                        value: coords.concat(rawData[i].slice(1))
                    });
                }
            }
            return mapData;

        };


        function makeCoords() {
            var tempdata=[];
            for(var key in coordsMap){
                var arr=[];
                arr[0]=coordsMap[key][0];
                arr[1]=coordsMap[key][1];
                arr[2]=0;
                arr[3]=key;
                tempdata.push(arr)
            }
            return tempdata;
        }
        function makeVisualMapData(rawData){
            var visualMapData=[];
            for(var i=0;i<rawData.length;i++){
                var tempDict={};
                tempDict["name"]=rawData[i][0];
                tempDict["value"]=rawData[i][1];
                visualMapData.push(tempDict)
            }
            return visualMapData;
        }



        for(var n = 0; n < years.length; n++) {
            var yearDataDict = {};
            var selectData=[];
            for (var i = 0; i < data.length; i++) {
                if (yearDataDict[data[i].CountryName]) {
                    if(parseFloat(data[i][year])){
                        yearDataDict[data[i].CountryName].push(parseFloat(data[i][year]));
                    }
                    else{
                        yearDataDict[data[i].CountryName].push(0.0);
                    }
                }else {
                    var year= "YR" + years[n];
                    yearDataDict[data[i].CountryName] = [];
                    if(parseFloat(data[i][year])){
                        yearDataDict[data[i].CountryName].push(parseFloat(data[i][year]));
                    }
                    else{
                        yearDataDict[data[i].CountryName].push(0.0);
                    }
                }

            }

            var rawData=dictToArray(yearDataDict);
            var visualMapDate=makeVisualMapData(rawData);
            superdata.push(rawData)


            option.options.push({
                title: {
                    text: years[n]+"年",
                },

                series:[
                    {
                        name:  "Test",
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        data:  makeMapData(rawData),
                        activeOpacity: 1,
                        symbolSize: 5,
                        itemStyle: {
                            normal: {
                                borderColor:'#fff',
                                color: '#577ceb',
                            }
                        }
                    },
                    {
                        type: 'map',
                        map: 'world',
                        roam: true,
                        top: 20,
                        left: "10%",
                        bottom: '40%',
                        silent:true,
                        itemStyle: {
                            normal: {
                                areaColor: '#eeeeef',
                                borderColor: '#000'
                            },
                            emphasis: {
                                areaColor: '#ffd000'
                            }
                        },
                        label: {
                            emphasis: {
                                color: '#e20000',
                                show: false,
                            }
                        },
                        selectedMode: 'multiple',
                        data:visualMapDate,
                    },


                    {
                        name: 'parallel',
                        type: 'parallel',
                        smooth: true,
                        lineStyle: {
                            normal: {
                                color: '#577ccc',
                                width: 0.5,
                                opacity: 0.4
                            }
                        },
                        blendMode: 'lighter',
                        data: rawData
                    },

                ]
            });



        }
      //  chart.setOption(option)


        /*       var testData=dictToArray(coordsMap);
               for(var i=0;i<rawData.length;i++){
                 if(rawData[i][0]!=testData[i][0]){
                     console.log(rawData[i][0]);
                     console.log(testData[i][0]);
                     console.log(i+50);

                 }
             }
*/
        setTimeout(function() {
            chart.setOption(option);
            window.onresize = function() {
                chart.resize();
            }
        }, 200)	;





    });
</script>
<div id="secondCharts" style="width:13%;height:300px;"></div>


<script>

    d3.csv("countries_1990_2015.csv",function(data) {
        var	secondCharts = echarts.init(document.getElementById('secondCharts'));
        var selectYear=0;
        var selectName="China";
        var selectData=[];
        var lastYear=0;
        var symbol=0;
        function selectValue(value){
            var selectData=[];
            for(var i=0;i<data.length;i++){
                for(var key in data[i]){
                    if(data[i][key]==value){
                        selectData.push(data[i]);
                    }
                }
            }
            return selectData;
        }
        function getOneYear(test,year){
            var dataTemp={};
            year = year - 1986;
            for(var i=0;i<test.length;i++){
                var name = test[i].CountryName;
                var j = 0;
                for( var key in test[i]) {
                    if (j == year) {
                        strValue = parseFloat(test[i][key]);
                        if(strValue){
                            dataTemp[name] = strValue;
                        }
                        else {
                            dataTemp[name] = -100;
                        }
                    }
                    j += 1;
                }
            }
            return dataTemp;
        }
        function countrySort(dic){
            var dataSorted=[];
            var res = Object.keys(dic).sort(function(a,b){
                return dic[b]-dic[a];
            });
            for(var i=0;i<res.length;i++)
                dataSorted[res[i]]=dic[res[i]];
            return dataSorted;
        }
        function sortedAllYear(test) {
            dataSort = [];
            for(var i=1990;i<2016;i++){
                var temp = countrySort(getOneYear(test, i))
                dataSort.push(temp)
            }
            return dataSort
        }
        function getSortedNum(sortedData,countryName){
            var i=0;
            for(var key in sortedData){
                i+=1;
                if(key==countryName){
                    break;
                }
            }
            return i;
        }

        chart.on('timeLineChanged', function (params) {
            selectYear = params.currentIndex;
            if(symbol==0){
                lastYear=selectYear;
                symbol=1;
            }
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                    //console.log(selectData);
                }
                lastYear=selectYear;
            }
            //document.getElementById("secondCharts").style.display="none";
            var rank=getSortedNum(sortedAllYear(selectValue("SP.POP.TOTL"))[selectYear],selectData[0]);
            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"总人口",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "总人口 ：" + parseInt(selectData[6]/10000)+"（万人）排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },
                        },
                        data: [
                            {value: parseInt(selectData[6] * (selectData[5] / 100)/10000), name: '女'},
                            {value: parseInt(selectData[6] * (1 - selectData[5] / 100)/10000), name: '男'},
                        ]
                    }
                ]
            }
            secondCharts.setOption(option)
        });
        /*     chart.on('click', function (params) {
                  var selectName = params.name;
                  console.log(selectYear)
                  console.log(selectName)
                  if(lastYear!=selectYear)
                      selectData=[];
                  for(var i=0;i<superdata[selectYear].length;i++){
                      if(superdata[selectYear][i][0]==selectName){
                          selectData.push(superdata[selectYear][i]);
                          console.log(selectData);
                      }
                      lastYear=selectYear;
                  }
              });
         */     chart.on('click', function (params) {
            //document.getElementById("secondCharts").style.display="";
            selectName = params.name;
            //console.log(selectYear)
            //console.log(selectName)
            if(lastYear!=selectYear)
                selectData=[];
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                    //console.log(selectData);
                }
                lastYear=selectYear;
            }
            var rank=getSortedNum(sortedAllYear(selectValue("SP.POP.TOTL"))[selectYear],selectData[0]);


            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"总人口",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "总人口 ：" + parseInt(selectData[6]/10000)+"（万人）排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },
                        },
                        data: [
                            {value: parseInt(selectData[6] * (selectData[5] / 100)/10000), name: '女'},
                            {value: parseInt(selectData[6] * (1 - selectData[5] / 100)/10000), name: '男'},
                        ]
                    }
                ]
            }
            secondCharts.setOption(option)
        });

    });


</script>
<div id="thridCharts" style="width:13%;height:300px;"></div>
<script>
    d3.csv("countries_1990_2015.csv",function(data) {
        var	thridCharts = echarts.init(document.getElementById('thridCharts'));
        var selectYear=0;
        var selectName="China";
        var selectData=[];
        var lastYear=0;
        var symbol=0;
        function selectValue(value){
            var selectData=[];
            for(var i=0;i<data.length;i++){
                for(var key in data[i]){
                    if(data[i][key]==value){
                        selectData.push(data[i]);
                    }
                }
            }
            return selectData;
        }
        function getOneYear(test,year){
            var dataTemp={};
            year = year - 1986;
            for(var i=0;i<test.length;i++){
                var name = test[i].CountryName;
                var j = 0;
                for( var key in test[i]) {
                    if (j == year) {
                        strValue = parseFloat(test[i][key]);
                        if(strValue){
                            dataTemp[name] = strValue;
                        }
                        else {
                            dataTemp[name] = -100;
                        }
                    }
                    j += 1;
                }
            }
            return dataTemp;
        }
        function countrySort(dic){
            var dataSorted=[];
            var res = Object.keys(dic).sort(function(a,b){
                return dic[b]-dic[a];
            });
            for(var i=0;i<res.length;i++)
                dataSorted[res[i]]=dic[res[i]];
            return dataSorted;
        }
        function sortedAllYear(test) {
            dataSort = [];
            for(var i=1990;i<2016;i++){
                var temp = countrySort(getOneYear(test, i))
                dataSort.push(temp)
            }
            return dataSort
        }
        function getSortedNum(sortedData,countryName){
            var i=0;
            for(var key in sortedData){
                i+=1;
                if(key==countryName){
                    break;
                }
            }
            return i;
        }
        chart.on('timeLineChanged', function (params) {
            selectYear = params.currentIndex;
            if(symbol==0){
                lastYear=selectYear;
                symbol=1;
            };
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                    //console.log(selectData);
                }
                lastYear=selectYear;
            }
            //document.getElementById("thridCharts").style.display="none";
            var rank=getSortedNum(sortedAllYear(selectValue("SL.TLF.TOTL.IN"))[selectYear],selectData[0]);
            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"劳动力人数",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "劳动力 ：" + parseInt(selectData[10]/10000)+" （万人）排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },
                        },
                        data: [
                            {value: parseInt(selectData[10] * (selectData[11] / 100)/10000), name: '女'},
                            {value: parseInt(selectData[10] * (1 - selectData[11] / 100)/10000), name: '男'},
                        ]
                    }
                ]
            }
            thridCharts.setOption(option)

        });

        chart.on('click', function (params) {
            // document.getElementById("thridCharts").style.display="";
            selectName = params.name;
            //console.log(selectYear)
            //console.log(selectName)
            if(lastYear!=selectYear)
                selectData=[];
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                }
                lastYear=selectYear;
            }
            var rank=getSortedNum(sortedAllYear(selectValue("SL.TLF.TOTL.IN"))[selectYear],selectData[0]);
            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"劳动力人数",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "劳动力 ：" + parseInt(selectData[10]/10000)+" （万人）排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },
                        },
                        data: [
                            {value: parseInt(selectData[10] * (selectData[11] / 100)/10000), name: '女'},
                            {value: parseInt(selectData[10] * (1 - selectData[11] / 100)/10000), name: '男'},
                        ]
                    }
                ]
            }
            thridCharts.setOption(option)
        });

    });


</script>
<div id="fourthCharts" style="width:14%;height:300px;"></div>
<script>
    d3.csv("countries_1990_2015.csv",function(data) {
        var fourthCharts = echarts.init(document.getElementById('fourthCharts'));
        var selectYear=0;
        var selectName="China";
        var selectData=[];
        var lastYear=0;
        var symbol=0;
        function selectValue(value){
            var selectData=[];
            for(var i=0;i<data.length;i++){
                for(var key in data[i]){
                    if(data[i][key]==value){
                        selectData.push(data[i]);
                    }
                }
            }
            return selectData;
        }
        function getOneYear(test,year){
            var dataTemp={};
            year = year - 1986;
            for(var i=0;i<test.length;i++){
                var name = test[i].CountryName;
                var j = 0;
                for( var key in test[i]) {
                    if (j == year) {
                        strValue = parseFloat(test[i][key]);
                        if(strValue){
                            dataTemp[name] = strValue;
                        }
                        else {
                            dataTemp[name] = -100;
                        }
                    }
                    j += 1;
                }
            }
            return dataTemp;
        }
        function countrySort(dic){
            var dataSorted=[];
            var res = Object.keys(dic).sort(function(a,b){
                return dic[b]-dic[a];
            });
            for(var i=0;i<res.length;i++)
                dataSorted[res[i]]=dic[res[i]];
            return dataSorted;
        }
        function sortedAllYear(test) {
            dataSort = [];
            for(var i=1990;i<2016;i++){
                var temp = countrySort(getOneYear(test, i))
                dataSort.push(temp)
            }
            return dataSort
        }
        function getSortedNum(sortedData,countryName){
            var i=0;
            for(var key in sortedData){
                i+=1;
                if(key==countryName){
                    break;
                }
            }
            return i;
        }
        chart.on('timeLineChanged', function (params) {
            selectYear = params.currentIndex;
            if(symbol==0){
                lastYear=selectYear;
                symbol=1;
            };
            // document.getElementById("fourthCharts").style.display="none";
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                }
                lastYear=selectYear;
            }
            var rank=getSortedNum(sortedAllYear(selectValue("SL.UEM.TOTL.ZS"))[selectYear],selectData[0]);


            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"失业人数",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女()', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "失业人数占总劳力:" + selectData[16].toFixed(2)+"%  排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },

                        },
                        data: [
                            {value: parseInt((selectData[10] * selectData[11]*selectData[17]/10000)/10000), name: '女(万人)'},
                            {value: parseInt((selectData[10] *  selectData[16]/100-selectData[10] * selectData[11]*selectData[17]/10000)/10000), name: '男(万人)'},
                        ]
                    }
                ]
            }
            fourthCharts.setOption(option)
        });

        chart.on('click', function (params) {
            //document.getElementById("fourthCharts").style.display="";
            selectName = params.name;
            //console.log(selectYear)
            //console.log(selectName)
            if(lastYear!=selectYear)
                selectData=[];
            for(var i=0;i<superdata[selectYear].length;i++){
                if(superdata[selectYear][i][0]==selectName){
                    selectData=superdata[selectYear][i];
                }
                lastYear=selectYear;
            }
            var rank=getSortedNum(sortedAllYear(selectValue("SL.UEM.TOTL.ZS"))[selectYear],selectData[0]);


            option= {
                tooltip: {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                title: {
                    left: 'center',
                    top:20,
                    text: selectData[0]+"失业人数",
                    textStyle: {
                        color: '#eee'
                    },
                },
                legend: {
                    x: 'left',
                    data: ['女()', '男'],
                    show: false,
                },
                calculable: true,
                series: [
                    {
                        name: "失业人数占总劳力 ：" + selectData[16].toFixed(2)+"%  排名："+rank,
                        type: 'pie',
                        radius: ['25%', '50%'],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: false
                                },
                                labelLine: {
                                    show: false
                                }
                            },

                        },
                        data: [
                            {value: parseInt((selectData[10] * selectData[11]*selectData[17]/10000)/10000), name: '女(万人)'},
                            {value: parseInt((selectData[10] *  selectData[16]/100-selectData[10] * selectData[11]*selectData[17]/10000)/10000), name: '男(万人)'},
                        ]
                    }
                ]
            }
            fourthCharts.setOption(option)
        });

    });


</script>
<div id="fifthCharts" style="width:40%;height:600px;"></div>
<script>
        var fifthCharts = echarts.init(document.getElementById('fifthCharts'));
        var selectYear=0;
        var selectName="China";
        var selectData=[];

        function getRadarData(array){
            var radarData=[];
            for(var i=0;i<array.length;i++){
                //console.log(array[i])
                var tempArray=[];
                var tempDict={}
                tempArray[0]=parseInt(array[i][13]);
                tempArray[1]=array[i][7].toFixed(2);
                tempArray[2]=array[i][3].toFixed(2);
                tempArray[3]=array[i][12].toFixed(2);
                tempArray[4]=array[i][15].toFixed(2);
                tempDict["value"]=tempArray;
                tempDict["name"]=array[i][0];
                radarData[i]=tempDict;
            }
            console.log(radarData);
            return radarData;
        }

        function getRadarLegend(dict){
            var legendData=[];
            for(var i=0;i<dict.length;i++){
                legendData[i]=dict[i].name;
            }
            return legendData
        }

        chart.on('click', function (params) {
            selectName = params.name;
            var j=0;
            for(j=0;j<selectData.length;j++){
                if(selectData[j][0]==selectName){
                    selectData.splice(j,1);
                }
            }
            if(j==selectData.length){
                for (var i = 0; i < superdata[selectYear].length; i++) {
                    if (superdata[selectYear][i][0] == selectName) {
                        selectData.push(superdata[selectYear][i]);
                        //console.log(selectData);
                    }
                }
            }
            var radarData=getRadarData(selectData);
            var legendData=getRadarLegend(radarData);
            option = {
                legend: {
                    data:legendData,
                },
                tooltip: {},

                radar: {
                    name: {
                        textStyle: {
                            color: '#fff',
                            backgroundColor: '#999',
                            borderRadius: 3,
                            padding: [3, 5]
                        }
                    },
                    scale:true,
                    axisLine:{
                        symbol:['none', 'arrow'],
                    },
                    splitArea: {
                        show: false
                    },
                    splitLine:{
                        show:false,
                    },
                    indicator: [
                        { name: '国土面积', max: 10000000},
                        { name: '人口增长率', min:-2,max: 10},
                        { name: '互联网用户', max: 70},
                        { name: '武装部队占比', max: 6},
                        { name: '耕地面积', max:40}
                    ]
                },
                series: [{
                    lineStyle:{
                        width:5,
                    },
                    emphasis:{
                        lineStyle:{
                            width:10,
                        }
                    },
                    label:{show:true},
                    name:"Radar",
                    type:"radar",
                    data:radarData,
                }]
            };
            fifthCharts.setOption(option);
        });

        chart.on('timeLineChanged', function (params) {
            selectYear = params.currentIndex;
            for (var i = 0; i < superdata[selectYear].length; i++) {
                for(var j=0;j<selectData.length;j++){
                    if (superdata[selectYear][i][0] == selectData[j][0]) {
                        selectData[j]=superdata[selectYear][i];
                        //console.log(selectData)
                    }
                }
            }
            var radarData=getRadarData(selectData);
            var legendData=getRadarLegend(radarData);
            option = {
                legend: {
                    data:legendData,
                },
                tooltip:{},

                radar: {
                    name: {
                        textStyle: {
                            color: '#fff',
                            backgroundColor: '#999',
                            borderRadius: 3,
                            padding: [3, 5]
                        }
                    },
                    scale:true,
                    emphasis:{
                        lineStyle:{
                            width:10,
                        }
                    },
                    axisLine:{
                        symbol:['none', 'arrow'],
                    },
                    splitArea: {
                        show: false
                    },
                    splitLine:{
                        show:false,
                    },
                    indicator: [
                        { name: '国土面积', max: 10000000},
                        { name: '人口增长率', min:-2,max: 10},
                        { name: '互联网用户占比', max: 70},
                        { name: '武装部队占比', max: 6},
                        { name: '耕地面积占比', max:40}
                    ]
                },
                series: [{
                    lineStyle:{
                        width:5,


                    },
                    emphasis:{
                        label:{show:true,},
                        lineStyle:{width:3,},
                    },
                    name:"Radar",
                    label:{show:true},
                    type:"radar",
                    data:radarData,
                }]
            };
            fifthCharts.setOption(option);
        });



</script>
</body>

</html>
